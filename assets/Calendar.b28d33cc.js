var o=Object.defineProperty;var h=(n,r,t)=>r in n?o(n,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[r]=t;var e=(n,r,t)=>(h(n,typeof r!="symbol"?r+"":r,t),t);import{W as c,G as a,a as i,D as u,l as s}from"./index.8d3f5313.js";import l from"./CalendarMonth.eb151538.js";import"./CalendarDay.d4827bba.js";import"./EventBus.9b451a44.js";const d=`<div class="calendar border">
    <span>Entries</span>
    <div class="calendar-navigation" >
        <a href="#" class="previous round">&#8249;</a>
        <span></span>
        <a href="#" class="next round">&#8250;</a>
    </div>
    <div class="month"></div>

</div>`,m=`main-calendar{display:flex;width:35%;flex-grow:1}.calendar{display:flex;flex-direction:column;height:100%}.calendar>span{text-align:center;font-size:var(--font-size-xlarge);padding-bottom:var(--spacing-large);padding-top:var(--spacing-medium)}.calendar-navigation>a{text-decoration:none;display:inline-block;padding:8px 16px;margin:15px}.calendar-navigation{display:flex;justify-content:center;font-size:var(--font-size-large);padding-bottom:var(--spacing-large)}.calendar-navigation>span{display:flex;align-items:center;margin:0}.calendar-navigation a:hover{background-color:var(--text-accent-hover);color:var(--text-header)}.calendar-navigation .previous,.calendar-navigation .next{background-color:var(--border-color);color:var(--text-header)}.calendar-navigation .round{border-radius:50%}
`;class y extends c{constructor(){super(d,m);e(this,"monthNumberDecember",12);e(this,"monthNumberJanuary",1);e(this,"calendarMonth");e(this,"currentMonthNumber");e(this,"currentMonthText");e(this,"currentYear");e(this,"calendarModel");e(this,"entriesForCurrentMonth");e(this,"currentYearNumber");e(this,"$monthTitle");e(this,"$previousButton");e(this,"$nextButton");e(this,"today");e(this,"noteDays");e(this,"onPreviousClicked",()=>{this.currentMonthNumber--,this.getEntriesForMonth(!1)});e(this,"onNextClicked",()=>{this.currentMonthNumber++,this.getEntriesForMonth(!0)});e(this,"removeMonthEntries",()=>{this.select(".month").innerHTML=""})}get htmlTagName(){return"main-calendar"}onCreate(){return this.initData().then(()=>{this.$initHtml(),this.initListeners(),this.noteDays=this.calendarModel.noteDays,this.today=this.calendarModel.today,this.getCurrentData(),this.getEntriesForMonth(!1)})}async initData(){if(!a.hasState(i.calendarModel)){const t=await u.getCalendarModel();if(t)a.addState(t.toState(),i.calendarModel);else throw new Error("Could not load calendar model")}this.calendarModel=a.getStateById(i.calendarModel).value}$initHtml(){this.$monthTitle=this.select(".calendar-navigation span"),this.$previousButton=this.select(".previous"),this.$nextButton=this.select(".next")}initListeners(){this.$previousButton.addEventListener("click",this.onPreviousClicked),this.$nextButton.addEventListener("click",this.onNextClicked)}getCurrentData(){this.currentYearNumber=this.today.getFullYear(),this.currentYear=this.currentYearNumber.toString(),this.currentMonthNumber=this.today.getMonth()+1}setMonthTitle(){const t=new Date(`${this.currentMonthNumber}/${1}/${this.currentYear}`);this.currentMonthText=t.toLocaleString("default",{month:"long"}),this.$monthTitle.innerText=this.currentMonthText}getEntriesForMonth(t){s(this.currentMonthNumber),this.checkForYearTransition(),this.entriesForCurrentMonth=this.getEntryData(),this.setEntries(t)}checkForYearTransition(){this.currentMonthNumber<1&&(this.currentMonthNumber=this.monthNumberDecember,this.currentYearNumber=parseInt(this.currentYear)-1),this.currentMonthNumber>12&&(this.currentMonthNumber=this.monthNumberJanuary,this.currentYearNumber=parseInt(this.currentYear)+1),this.currentYear=this.currentYearNumber.toString()}getEntryData(){s("get Entry "+this.currentMonthNumber);const t=this.getDaysFromNoteDays();return t.length===0&&this.currentNumbersMatchToday()&&t.push(this.today.getDate()+""),t}getDaysFromNoteDays(){let t=[];return this.noteDays[this.currentYear]&&this.noteDays[this.currentYear][this.currentMonthNumber]&&(t=this.noteDays[this.currentYear][this.currentMonthNumber]),t}currentNumbersMatchToday(){return this.currentMonthNumber===this.today.getMonth()+1&&this.currentYear===this.today.getFullYear().toString()}setEntries(t){this.entriesForCurrentMonth.length>0?(this.removeMonthEntries(),this.setMonthTitle(),this.showEntries()):t?(s(this.checkForClickInTheFuture()),this.checkForClickInTheFuture()&&this.currentMonthNumber++):(this.currentMonthNumber--,this.getEntriesForMonth(t))}checkForClickInTheFuture(){return this.currentMonthNumber+1<=this.today.getMonth()+1&&this.currentYear===this.today.getFullYear().toString()}showEntries(){this.calendarMonth=new l(this.entriesForCurrentMonth,this.currentMonthNumber,this.currentYear),this.select(".month").append(this.calendarMonth)}}export{y as default};
